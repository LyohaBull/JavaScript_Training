<!DOCTYPE HTML>
<html>
<body>

  <ul>
    <li>Животные
      <ul>
        <li>Млекопитающие
          <ul>
            <li>Коровы</li>
            <li>Ослы</li>
            <li>Собаки</li>
            <li>Тигры</li>
          </ul>
        </li>
        <li>Другие
          <ul>
            <li>Змеи</li>
            <li>Птицы</li>
            <li>Ящерицы</li>
          </ul>
        </li>
      </ul>
    </li>
    <li>Рыбы
      <ul>
        <li>Аквариумные
          <ul>
            <li>Гуппи</li>
            <li>Скалярии</li>
          </ul>
        </li>
        <li>Морские
          <ul>
            <li>Морская форель</li>
          </ul>
        </li>
      </ul>
    </li>
  </ul>

  <script>
    let uls = document.querySelectorAll('ul');
    for (let i=1;i<uls.length;i++) {
		let sib = uls[i].previousSibling;
		if (sib.nodeName == "#text") sib.data = sib.data.slice(0,sib.data.indexOf("\n")) + " [" + liCount(uls[i]) + "]" + sib.data.slice(sib.data.indexOf("\n"));
	}
	function liCount(ul) {
		let uls = ul.querySelectorAll('ul');
		if (!uls.length) 
			return ul.querySelectorAll('li').length
		else {
			let sum=0;
			for (let ul1 of uls)
				sum += liCount(ul1);
			return sum;
		}
	}
			
  </script>

</body>
</html>